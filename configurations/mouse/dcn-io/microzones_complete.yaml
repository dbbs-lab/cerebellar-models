name: DBBS Mouse cerebellum w/ DCN and IO split in microzones
packages:
  - cerebellum~=0.4.0
  - bsb-core~=4.5
  - bsb-json~=4.2
  - bsb-yaml~=4.2
  - bsb-hdf5~=4.1
storage:
  engine: hdf5
  root: mouse_cereb_microzones_complete.hdf5
network:
  x: 300
  y: 200
  z: 695
regions:
  cerebellar_cortex:
    type: group
    children:
      - granular_layer
      - purkinje_layer_plus
      - purkinje_layer_minus
      - b_molecular_layer
      - t_molecular_layer
  cerebellar_nuclei:
    type: group
    children:
      - dcn_layer_plus
      - dcn_layer_minus
  io:
    type: group
    children:
      - io_layer_plus
      - io_layer_minus
partitions:
  io_layer_plus:
    type: rhomboid
    origin: [ 0, 0, 0 ]
    dimensions: [ 150, 200, 200 ]
  io_layer_minus:
    type: rhomboid
    origin: [ 150, 0, 0 ]
    dimensions: [ 150, 200, 200 ]
  dcn_layer_plus:
    type: rhomboid
    origin: [ 0, 0, 200 ]
    dimensions: [ 150, 200, 200 ]
  dcn_layer_minus:
    type: rhomboid
    origin: [ 150, 0, 200 ]
    dimensions: [ 150, 200, 200 ]
  granular_layer:
    type: rhomboid
    origin: [0, 0, 400]
    dimensions: [300, 200, 130]
  purkinje_layer_plus:
    type: rhomboid
    origin: [0, 0, 530]
    dimensions: [150, 200, 15]
  purkinje_layer_minus:
    type: rhomboid
    origin: [ 150, 0, 530 ]
    dimensions: [ 150, 200, 15 ]
  b_molecular_layer:
    type: rhomboid
    origin: [ 0, 0, 545 ]
    dimensions: [ 300, 200, 50 ]
  t_molecular_layer:
    type: rhomboid
    origin: [ 0, 0, 595 ]
    dimensions: [ 300, 200, 100 ]
cell_types:
  glomerulus:
    spatial:
      density: 0.0003
      radius: 1.5
    plotting:
      display_name: Glomerulus
  mossy_fibers:
    spatial:
      count_ratio: 0.05
      radius: 1
      relative_to: glomerulus
  granule_cell:
    spatial:
      density: 0.0039
      morphologies:
        - GranuleCell
      radius: 2.5
    plotting:
      display_name: Granule cell
      opacity: 0.3
  golgi_cell:
    spatial:
      density: 0.000009
      morphologies:
        - GolgiCell
      radius: 8
    plotting:
      display_name: Golgi cell
  basket_cell:
    spatial:
      density: 0.00005
      morphologies:
        - BasketCell
      radius: 6
    plotting:
      display_name: Basket cell
  stellate_cell:
    spatial:
      density: 0.00005
      morphologies:
        - StellateCell
      radius: 4
    plotting:
      display_name: Stellate cell
  purkinje_cell_plus:
    spatial:
      morphologies:
        - PurkinjeCell
      planar_density: 0.001166
      radius: 7.5
    plotting:
      display_name: Purkinje cell plus
  purkinje_cell_minus:
    spatial:
      morphologies:
        - PurkinjeCell
      planar_density: 0.001166
      radius: 7.5
    plotting:
      display_name: Purkinje cell minus
  dcn_p_plus:
    spatial:
      radius: 9.5
      density: 9.92e-6
    plotting:
      display_name: Deep Cerebellar Nuclei type p plus
  dcn_p_minus:
    spatial:
      radius: 9.5
      density: 9.92e-6
    plotting:
      display_name: Deep Cerebellar Nuclei type p minus
  dcn_i_plus:
    spatial:
      radius: 7.0
      density: 5.58e-6
    plotting:
      display_name: Deep Cerebellar Nuclei type i plus
  dcn_i_minus:
    spatial:
      radius: 7.0
      density: 5.58e-6
    plotting:
      display_name: Deep Cerebellar Nuclei type i minus
  io_plus:
    spatial:
      count_ratio: 0.2
      radius: 7.5
      relative_to: purkinje_cell_plus
    plotting:
      display_name: Inferior olive cells plus
  io_minus:
    spatial:
      count_ratio: 0.2
      radius: 7.5
      relative_to: purkinje_cell_minus
    plotting:
      display_name: Inferior olive cells minus
placement:
  granular_layer_innervation:
    strategy: bsb.placement.RandomPlacement
    partitions:
      - granular_layer
    cell_types:
      - mossy_fibers
  granular_layer_placement:
    strategy: bsb.placement.RandomPlacement
    partitions:
      - granular_layer
    cell_types:
      - granule_cell
      - golgi_cell
      - glomerulus
  basket_layer_placement:
    strategy: bsb.placement.RandomPlacement
    partitions:
      - b_molecular_layer
    cell_types:
      - basket_cell
  stellate_layer_placement:
    strategy: bsb.placement.RandomPlacement
    partitions:
      - t_molecular_layer
    cell_types:
      - stellate_cell
  purkinje_layer_placement_plus:
    strategy: bsb.placement.ParallelArrayPlacement
    partitions:
      - purkinje_layer_plus
    cell_types:
      - purkinje_cell_plus
    spacing_x: 130
    angle: 80
  purkinje_layer_placement_minus:
    strategy: bsb.placement.ParallelArrayPlacement
    partitions:
      - purkinje_layer_minus
    cell_types:
      - purkinje_cell_minus
    spacing_x: 130
    angle: 80
  dcn_p_layer_placement_plus:
    strategy: bsb.placement.RandomPlacement
    partitions:
      - dcn_layer_plus
    cell_types:
      - dcn_p_plus
  dcn_p_layer_placement_minus:
    strategy: bsb.placement.RandomPlacement
    partitions:
      - dcn_layer_minus
    cell_types:
      - dcn_p_minus
  dcn_i_layer_placement_plus:
    strategy: bsb.placement.RandomPlacement
    partitions:
      - dcn_layer_plus
    cell_types:
      - dcn_i_plus
  dcn_i_layer_placement_minus:
    strategy: bsb.placement.RandomPlacement
    partitions:
      - dcn_layer_minus
    cell_types:
      - dcn_i_minus
  io_layer_placement_plus:
    strategy: bsb.placement.RandomPlacement
    partitions:
      - io_layer_plus
    cell_types:
      - io_plus
  io_layer_placement_minus:
    strategy: bsb.placement.RandomPlacement
    partitions:
      - io_layer_minus
    cell_types:
      - io_minus
connectivity:
  mossy_fibers_to_glomerulus:
    strategy: cerebellum.connectome.to_glomerulus.ConnectomeMossyGlomerulus
    presynaptic:
      cell_types:
        - mossy_fibers
    postsynaptic:
      cell_types:
        - glomerulus
    x_length: 60
    y_length: 20
  glomerulus_to_granule:
    strategy: cerebellum.connectome.glomerulus_granule.ConnectomeGlomerulusGranule
    presynaptic:
      cell_types:
        - glomerulus
    postsynaptic:
      cell_types:
        - granule_cell
      morphology_labels:
        - dendrites
    pre_glom_strats:
      - mossy_fibers_to_glomerulus
    pre_cell_types:
      - mossy_fibers
    radius: 40
    convergence: 4
  glomerulus_to_golgi:
    strategy: cerebellum.connectome.glomerulus_golgi.ConnectomeGlomerulusGolgi
    presynaptic:
      cell_types:
        - glomerulus
    postsynaptic:
      cell_types:
        - golgi_cell
      morphology_labels:
        - basal_dendrites
    radius: 50
  golgi_to_glomerulus:
    strategy: cerebellum.connectome.golgi_glomerulus.ConnectomeGolgiGlomerulus
    presynaptic:
      cell_types:
        - golgi_cell
      morphology_labels:
        - axon
    postsynaptic:
      cell_types:
        - granule_cell
    glom_post_strats:
      - glomerulus_to_granule
    glom_cell_types:
      - glomerulus
    radius: 150
    divergence: 40
  golgi_to_golgi:
    strategy: bsb.connectivity.VoxelIntersection
    presynaptic:
      cell_types:
        - golgi_cell
      morphology_labels:
        - axon
    postsynaptic:
      cell_types:
        - golgi_cell
      morphology_labels:
        - basal_dendrites
    affinity: 0.5
    voxels_pre: 500
    voxels_post: 500
    contacts:
      distribution: norm
      loc: 160
      scale: 5
  gap_goc:
    strategy: bsb.connectivity.VoxelIntersection
    presynaptic:
      cell_types:
        - golgi_cell
      morphology_labels:
        - basal_dendrites
    postsynaptic:
      cell_types:
        - golgi_cell
      morphology_labels:
        - basal_dendrites
    affinity: 0.3
    voxels_pre: 500
    voxels_post: 500
    contacts:
      distribution: norm
      loc: 3
      scale: 1
  ascending_axon_to_golgi:
    strategy: bsb.connectivity.VoxelIntersection
    presynaptic:
      cell_types:
        - granule_cell
      morphology_labels:
        - ascending_axon
    postsynaptic:
      cell_types:
        - golgi_cell
      morphology_labels:
        - basal_dendrites
    affinity: 0.05
    voxels_pre: 500
    voxels_post: 500
  parallel_fiber_to_golgi:
    strategy: bsb.connectivity.VoxelIntersection
    presynaptic:
      cell_types:
        - granule_cell
      morphology_labels:
        - parallel_fiber
    postsynaptic:
      cell_types:
        - golgi_cell
      morphology_labels:
        - apical_dendrites
    affinity: 0.08
    voxels_pre: 500
    voxels_post: 500
  ascending_axon_to_purkinje_plus:
    strategy: bsb.connectivity.VoxelIntersection
    presynaptic:
      cell_types:
        - granule_cell
      morphology_labels:
        - ascending_axon
    postsynaptic:
      cell_types:
        - purkinje_cell_plus
      morphology_labels:
        - aa_targets
    affinity: 0.05
    voxels_pre: 500
    voxels_post: 500
  parallel_fiber_to_purkinje_plus:
    strategy: bsb.connectivity.VoxelIntersection
    presynaptic:
      cell_types:
        - granule_cell
      morphology_labels:
        - parallel_fiber
    postsynaptic:
      cell_types:
        - purkinje_cell_plus
      morphology_labels:
        - pf_targets
    affinity: 0.1
    voxels_pre: 500
    voxels_post: 500
  parallel_fiber_to_basket:
    strategy: bsb.connectivity.VoxelIntersection
    presynaptic:
      cell_types:
        - granule_cell
      morphology_labels:
        - parallel_fiber
    postsynaptic:
      cell_types:
        - basket_cell
      morphology_labels:
        - dendrites
    affinity: 0.08
    voxels_pre: 500
    voxels_post: 500
  parallel_fiber_to_stellate:
    strategy: bsb.connectivity.VoxelIntersection
    presynaptic:
      cell_types:
        - granule_cell
      morphology_labels:
        - parallel_fiber
    postsynaptic:
      cell_types:
        - stellate_cell
      morphology_labels:
        - dendrites
    affinity: 0.08
    voxels_pre: 500
    voxels_post: 500
  stellate_to_purkinje_plus:
    strategy: bsb.connectivity.VoxelIntersection
    presynaptic:
      cell_types:
        - stellate_cell
      morphology_labels:
        - axon
    postsynaptic:
      cell_types:
        - purkinje_cell_plus
      morphology_labels:
        - sc_targets
    affinity: 0.1
    voxels_pre: 500
    voxels_post: 500
    contacts:
      distribution: norm
      loc: 10
      scale: 0.3
  basket_to_purkinje_plus:
    strategy: bsb.connectivity.VoxelIntersection
    presynaptic:
      cell_types:
        - basket_cell
      morphology_labels:
        - axon
    postsynaptic:
      cell_types:
        - purkinje_cell_plus
      morphology_labels:
        - soma
    voxels_pre: 500
    voxels_post: 500
  stellate_to_stellate:
    strategy: bsb.connectivity.VoxelIntersection
    presynaptic:
      cell_types:
        - stellate_cell
      morphology_labels:
        - axon
    postsynaptic:
      cell_types:
        - stellate_cell
      morphology_labels:
        - dendrites
    affinity: 0.3
    voxels_pre: 500
    voxels_post: 500
    contacts:
      distribution: norm
      loc: 100
      scale: 4
  basket_to_basket:
    strategy: bsb.connectivity.VoxelIntersection
    presynaptic:
      cell_types:
        - basket_cell
      morphology_labels:
        - axon
    postsynaptic:
      cell_types:
        - basket_cell
      morphology_labels:
        - dendrites
    affinity: 0.5
    voxels_pre: 500
    voxels_post: 500
    contacts:
      distribution: norm
      loc: 100
      scale: 4
  ascending_axon_to_purkinje_minus:
    strategy: bsb.connectivity.VoxelIntersection
    presynaptic:
      cell_types:
        - granule_cell
      morphology_labels:
        - ascending_axon
    postsynaptic:
      cell_types:
        - purkinje_cell_minus
      morphology_labels:
        - aa_targets
    affinity: 0.05
    voxels_pre: 500
    voxels_post: 500
#    contacts:
#      distribution: norm
#      loc: 3
#      scale: 1
  parallel_fiber_to_purkinje_minus:
    strategy: bsb.connectivity.VoxelIntersection
    presynaptic:
      cell_types:
        - granule_cell
      morphology_labels:
        - parallel_fiber
    postsynaptic:
      cell_types:
        - purkinje_cell_minus
      morphology_labels:
        - pf_targets
    affinity: 0.1
    voxels_pre: 500
    voxels_post: 500
  stellate_to_purkinje_minus:
    strategy: bsb.connectivity.VoxelIntersection
    presynaptic:
      cell_types:
        - stellate_cell
      morphology_labels:
        - axon
    postsynaptic:
      cell_types:
        - purkinje_cell_minus
      morphology_labels:
        - sc_targets
    affinity: 0.1
    voxels_pre: 500
    voxels_post: 500
    contacts:
      distribution: norm
      loc: 10
      scale: 0.3
  basket_to_purkinje_minus:
    strategy: bsb.connectivity.VoxelIntersection
    presynaptic:
      cell_types:
        - basket_cell
      morphology_labels:
        - axon
    postsynaptic:
      cell_types:
        - purkinje_cell_minus
      morphology_labels:
        - soma
    voxels_pre: 500
    voxels_post: 500
  purkinje_to_dcn_p_plus:
    strategy: bsb.connectivity.FixedOutdegree
    outdegree: 45 # 5
    presynaptic:
      cell_types:
        - purkinje_cell_plus
      morphology_labels:
        - axon
    postsynaptic:
      cell_types:
        - dcn_p_plus
  purkinje_to_dcn_p_minus:
    strategy: bsb.connectivity.FixedOutdegree
    outdegree: 45 # 5
    presynaptic:
      cell_types:
        - purkinje_cell_minus
      morphology_labels:
        - axon
    postsynaptic:
      cell_types:
        - dcn_p_minus
  purkinje_to_dcn_i_plus:
    strategy: bsb.connectivity.FixedOutdegree
    outdegree: 12 # 5
    presynaptic:
      cell_types:
        - purkinje_cell_plus
      morphology_labels:
        - axon
    postsynaptic:
      cell_types:
        - dcn_i_plus
  purkinje_to_dcn_i_minus:
    strategy: bsb.connectivity.FixedOutdegree
    outdegree: 12 # 5
    presynaptic:
      cell_types:
        - purkinje_cell_minus
      morphology_labels:
        - axon
    postsynaptic:
      cell_types:
        - dcn_i_minus
  mossy_fibers_to_dcn_p_plus:
    strategy: bsb.connectivity.FixedIndegree
    indegree: 48
    presynaptic:
      cell_types:
        - mossy_fibers
    postsynaptic:
      cell_types:
        - dcn_p_plus
  mossy_fibers_to_dcn_p_minus:
    strategy: bsb.connectivity.FixedIndegree
    indegree: 48
    presynaptic:
      cell_types:
        - mossy_fibers
    postsynaptic:
      cell_types:
        - dcn_p_minus
  io_to_purkinje_plus:
    strategy: bsb.connectivity.FixedIndegree
    presynaptic:
      cell_types:
        - io_plus
    postsynaptic:
      cell_types:
        - purkinje_cell_plus
    indegree: 1
  io_to_purkinje_minus:
    strategy: bsb.connectivity.FixedIndegree
    presynaptic:
      cell_types:
        - io_minus
    postsynaptic:
      cell_types:
        - purkinje_cell_minus
    indegree: 1
  io_to_mli_plus:
    strategy: cerebellum.connectome.io_molecular.ConnectomeIO_MLI
    presynaptic:
      cell_types:
        - io_plus
    postsynaptic:
      cell_types:
        - basket_cell
        - stellate_cell
    mli_pc_connectivity:
      - basket_to_purkinje_plus
      - stellate_to_purkinje_plus
    io_pc_connectivity: io_to_purkinje_plus
    pre_cell_pc: purkinje_cell_plus
  io_to_mli_minus:
    strategy: cerebellum.connectome.io_molecular.ConnectomeIO_MLI
    presynaptic:
      cell_types:
        - io_minus
    postsynaptic:
      cell_types:
        - basket_cell
        - stellate_cell
    mli_pc_connectivity:
      - basket_to_purkinje_minus
      - stellate_to_purkinje_minus
    io_pc_connectivity: io_to_purkinje_minus
    pre_cell_pc: purkinje_cell_minus
  io_to_dcn_p_plus:
    strategy: bsb.connectivity.FixedOutdegree
    presynaptic:
      cell_types:
        - io_plus
    postsynaptic:
      cell_types:
        - dcn_p_plus
    outdegree: 30
  io_to_dcn_p_minus:
    strategy: bsb.connectivity.FixedOutdegree
    presynaptic:
      cell_types:
        - io_minus
    postsynaptic:
      cell_types:
        - dcn_p_minus
    outdegree: 30
  io_to_dcn_i_plus:
    strategy: bsb.connectivity.FixedOutdegree
    presynaptic:
      cell_types:
        - io_plus
    postsynaptic:
      cell_types:
        - dcn_i_plus
    outdegree: 16
  io_to_dcn_i_minus:
    strategy: bsb.connectivity.FixedOutdegree
    presynaptic:
      cell_types:
        - io_minus
    postsynaptic:
      cell_types:
        - dcn_i_minus
    outdegree: 16
  dcn_i_to_io_plus:
    strategy: bsb.connectivity.FixedIndegree
    presynaptic:
      cell_types:
        - dcn_i_plus
    postsynaptic:
      cell_types:
        - io_plus
    indegree: 16
  dcn_i_to_io_minus:
    strategy: bsb.connectivity.FixedIndegree
    presynaptic:
      cell_types:
        - dcn_i_minus
    postsynaptic:
      cell_types:
        - io_minus
    indegree: 16
$import:
  ref: ../../../morphologies/morphologies.yaml#/
  values:
    - morphologies